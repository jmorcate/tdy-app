<%= form_for @tdy_request do |f| %>
    <%= render 'shared/error_messages' %>
    
    
    <!-- First row: displays the users images so you can select the users to include in the TDY Request -->
    <div class ='row' id= "travellers-list">
        
        <h3><i class="fa fa-users" aria-hidden="true"></i> Who</h3>
        <hr>
        <% @users.each do |user| %>
            <div class="col-md-1 form-panel traveller">
                <%= image_tag("#{user.email}.jpg", alt: user.name, class:"img-circle traveller") %> 
                <%= check_box_tag "tdy_request[user_ids][]", user.id, false ,class:"traveller" %>
             </div>
        <% end %>

    </div>  <!-- End of travellers list -->
    
    
    <!-- Second row: displaying: where, why and addiotional data. -->
    
    <div class="row">
        
        <div id='where' class='form-panel col-md-4'>
            
            <h3><i class="fa fa-map-signs" aria-hidden="true"></i> Where?</h3>
            <hr>
            <div class='form-group' >
                 <%= f.label :destination, class:'form-label' %>
                 <%= f.text_field :destination, class:'form-control form-input',  data: { autocomplete_source: TdyRequest.order(:destination).map(&:destination)} %>
             </div>
             <div class='form-group' >
                 <%= f.label :destination_aiport, class:'form-label' %>
                 <%= f.text_field :destination_airport, class:'form-control form-input' %>
             </div>
        </div>


        <div id='why' class='form-panel col-md-4'>
           <h3><i class="fa fa-bullseye" aria-hidden="true"></i> Why?</h3>
           <hr>
            <div class='form-group' >
                 <%= f.label :purpose, class:'form-label' %>
                 <%= f.text_field :purpose, class:'form-control form-input' %>
             </div>
        </div>
        
        
        <div id='additional' class='form-panel col-md-4'>
            <h3><i class="fa fa-plus-square" aria-hidden="true"></i> Additional Data?</h3>
            <hr>
            <div id="addtional_data">
                <ul class= "undecorated_list">
                    <li><%= f.check_box :advanced_allowance %>Advanced allowance</li>
                    <li><%= f.check_box :official_courier %>Official Courier</li>
                 </ul>
            </div>
            <div class= "form_group" >
                <%= f.label :budget, class:'form-label' %>
                <%= f.text_field :budget, class: 'form-control  form-input' %>
            </div>

        </div>

    </div> <!-- where, why and addiotional row -->


    <!-- Third row: When row -->
    <div class="row">
        <div class='form-panel col-md-12'>
            <h3><i class="fa fa-calendar" aria-hidden="true"></i> When?</h3>
            <hr>
        </div>
         <div  class='form-panel col-md-3'>

            <div class= "form_group" >
                <%= f.label :departure, class:'form-label' %>
                <%= f.datetime_select :departure, class: 'form-control form-input' %>
            </div>
            
        </div>
        <div class='form-panel col-md-3'>
            <div class= "form_group" >
                <%= f.label :return, class:'form-label' %>
                <%= f.datetime_select :return, class: 'form-control form-input' %>
            </div>
        </div>
        <div class='form-panel col-md-3'>
            <div class= "form_group" >
                <%= f.label :meeting_start, class:'form-label' %>
                <%= f.datetime_select :meeting_start, class: 'form-control form-input' %>
            </div>
        </div>
        <div class='form-panel col-md-3'>
            <div class= "form_group" >
                <%= f.label :meeting_end, class:'form-label' %>
                <%= f.datetime_select :meeting_end, class: 'form-control form-input' %>
            </div>
        </div>
        <script type="text/javascript">
            $(function () {
                $('.datetimepicker').datetimepicker({
                format: 'D-MMM-YYYY HH:mm'
                });
            });
        </script>

 
   </div> <!-- dates and details row -->

    <div class="row">
         <div id='how' class='form-panel col-md-6'>
            <h3><i class="fa fa-suitcase" aria-hidden="true"></i> How?</h3>
            <hr>
            <div id="transportation_list">
                <ul class= "undecorated_list">
                    <li><%= f.check_box :air %> <span><i class="fa fa-plane" aria-hidden="true"></i>Air</span></li>
                    <li><%= f.check_box :airport_service %> <span><i class="fa fa-taxi" aria-hidden="true"></i>Airport Service</span></li>
                    <li><%= f.check_box :train %> <span><i class="fa fa-train" aria-hidden="true"></i>Train</span></li>
                    <li><%= f.check_box :pomv, id:"pomv_check" %> <span><i class="fa fa-car" aria-hidden="true"></i>POVM</span></li>
                </ul>
            </div>

            <div class='form-group' >
                 <%= f.label :other_transportation,"Other:", class:'form-label' %>
                 <%= f.text_field :other_transportation, class:'form-control form-input' %>
            </div>
            <div id="pomv-details" >
                <div class="form-group">
                    <label for="sel1">Driver:</label>
                       <select class="form-control" id="sel1" name="tdy_request[driver_id]">
                          <option value=""></option>
                       </select>
                 </div>
            </div>
        </div>
        <div id='any_else' class='form-panel col-md-6'>
            <h3><i class="fa fa-bullhorn" aria-hidden="true"></i> Anything else to say?</h3>
            <hr>
            <div class='form-group' >
                 <%= f.text_area :comments, class:'form-control form-input' %>
            </div>
        </div>
   </div> <!-- dates and details row -->
    <%= f.submit "Create TDY Request", class: 'btn btn-lg btn-primary' %>
<% end %>
<script>
$(document).ready(function() {
    $(".traveller").click(function(event) {
        var name =this.nextSibling.data.trim();
        if (this.checked) {
            $('#sel1').append("<option value="+ this.value +" class='drivers'>" + name + "</option>");
        } else {
            $('.drivers[value="' + this.value + '"]').remove();
        };
    });

    $('#pomv_check').click(function() {
        $('#pomv-details').css('visibility', $('#pomv_check').prop('checked')? 'visible' : 'hidden');
    });

    $( "#tdy_request_destination" ).autocomplete({
      source:  $('#tdy_request_destination').data('autocomplete-source')
    });
});
</script>